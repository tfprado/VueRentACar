title = "LDAP test"
url = "/auth"
layout = "default"
is_hidden = 0
==
{##}
<div class="jumbotron">
    <div class="container">
        <h1>LDAP Test</h1>
    </div>
</div>

<div class="container">
    <form id="login" name="login" action="http://localhost:8080/api/october">
        <div>
            <input type="text" name="username" placeholder="Username">
        </div>

        <div>
            <input type="password" name="password" placeholder="Password">
        </div>

        <div>  
            <button id="submit" name="submit" type="submit" onclick="sendForm()">Login</button>
        </div>
        <ul>
        	{% for error in errors.all() %}
        		<li>
        			{{ error }}	
        		</li>
        	{% endfor %}
        </ul>
    </form>
    
    <p id="msg" class="" role="alert"></p>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script>
	function sendForm(){
		$('#login').submit(function(){
			$.post($(this).attr('action'), $(this).serialize(), function(json) {
				response = JSON.stringify(json, null, 4);
				//alert(str);
				if (json.message == "user found!" )
				{
					document.getElementById("msg").className = "alert alert-success";
					document.getElementById("msg").innerHTML = json.message;
					
					//window.location.replace("http://localhost:8000"); //redirects to another page, similar to HTTP redirect
					//window.location.href("http://localhost:8000"); //redirects to another page, similar to clicking on a link
				}
				else
				{
					document.getElementById("msg").className = "alert alert-danger";
					document.getElementById("msg").innerHTML = json.message;	
				}
			}, 'json');
			return false;
		});
	}
</script>